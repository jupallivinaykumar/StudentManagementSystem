{% extends 'core/admin_dashboard.html' %}

{% block content %}
<div class="container mt-4">
    <h2>{{ title }}</h2>
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endif %}
    <form method="post" enctype="multipart/form-data"> {# IMPORTANT: enctype for file uploads #}
        {% csrf_token %}
        <fieldset class="form-group border p-3 mb-4">
            <legend class="w-auto px-2">User Account Details</legend>
            <div class="mb-3">
                <label for="{{ user_form.username.id_for_label }}" class="form-label">Username</label>
                {{ user_form.username }}
                {% if user_form.username.errors %}<div class="text-danger">{{ user_form.username.errors }}</div>{% endif %}
            </div>
            <div class="mb-3">
                <label for="{{ user_form.email.id_for_label }}" class="form-label">Email</label>
                {{ user_form.email }}
                {% if user_form.email.errors %}<div class="text-danger">{{ user_form.email.errors }}</div>{% endif %}
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="{{ user_form.first_name.id_for_label }}" class="form-label">First Name</label>
                    {{ user_form.first_name }}
                    {% if user_form.first_name.errors %}<div class="text-danger">{{ user_form.first_name.errors }}</div>{% endif %}
                </div>
                <div class="col-md-6 mb-3">
                    <label for="{{ user_form.last_name.id_for_label }}" class="form-label">Last Name</label>
                    {{ user_form.last_name }}
                    {% if user_form.last_name.errors %}<div class="text-danger">{{ user_form.last_name.errors }}</div>{% endif %}
                </div>
            </div>
            <div class="mb-3">
                <label for="{{ user_form.profile_pic.id_for_label }}" class="form-label">Profile Picture</label>
                {{ user_form.profile_pic }}
                {% if user_form.profile_pic.errors %}<div class="text-danger">{{ user_form.profile_pic.errors }}</div>{% endif %}
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="{{ user_form.password.id_for_label }}" class="form-label">Password</label>
                    {{ user_form.password }}
                    {% if user_form.password.errors %}<div class="text-danger">{{ user_form.password.errors }}</div>{% endif %}
                    {% if user_form.password.help_text %}<div class="form-text text-muted">{{ user_form.password.help_text }}</div>{% endif %}
                </div>
                <div class="col-md-6 mb-3">
                    <label for="{{ user_form.confirm_password.id_for_label }}" class="form-label">Confirm Password</label>
                    {{ user_form.confirm_password }}
                    {% if user_form.confirm_password.errors %}<div class="text-danger">{{ user_form.confirm_password.errors }}</div>{% endif %}
                    {% if user_form.confirm_password.help_text %}<div class="form-text text-muted">{{ user_form.confirm_password.help_text }}</div>{% endif %}
                </div>
            </div>
        </fieldset>

        <fieldset class="form-group border p-3 mb-4">
            <legend class="w-auto px-2">Student Details</legend>
            <div class="mb-3">
                <label for="{{ profile_form.gender.id_for_label }}" class="form-label">Gender</label>
                {{ profile_form.gender }}
                {% if profile_form.gender.errors %}<div class="text-danger">{{ profile_form.gender.errors }}</div>{% endif %}
            </div>
            <div class="mb-3">
                <label for="{{ profile_form.address.id_for_label }}" class="form-label">Address</label>
                {{ profile_form.address }}
                {% if profile_form.address.errors %}<div class="text-danger">{{ profile_form.address.errors }}</div>{% endif %}
            </div>
            <div class="mb-3">
                <label for="{{ profile_form.course_id.id_for_label }}" class="form-label">Course</label>
                {{ profile_form.course_id }}
                {% if profile_form.course_id.errors %}<div class="text-danger">{{ profile_form.course_id.errors }}</div>{% endif %}
            </div>
            <div class="mb-3">
                <label for="{{ profile_form.session_year_id.id_for_label }}" class="form-label">Session Year</label>
                {{ profile_form.session_year_id }}
                {% if profile_form.session_year_id.errors %}<div class="text-danger">{{ profile_form.session_year_id.errors }}</div>{% endif %}
            </div>
            <div class="mb-3">
                <label for="{{ profile_form.date_of_birth.id_for_label }}" class="form-label">Date of Birth</label>
                {{ profile_form.date_of_birth }}
                {% if profile_form.date_of_birth.errors %}<div class="text-danger">{{ profile_form.date_of_birth.errors }}</div>{% endif %}
            </div>
        </fieldset>

        <button type="submit" class="btn btn-success">Add Student</button>
        <a href="{% url 'manage_students' %}" class="btn btn-secondary">Cancel</a>
    </form>
</div>
{% endblock %}